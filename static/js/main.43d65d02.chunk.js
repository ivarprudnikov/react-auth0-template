(this["webpackJsonptest-auth0-react-login"]=this["webpackJsonptest-auth0-react-login"]||[]).push([[0],{18:function(e){e.exports=JSON.parse('{"name":"test-auth0-react-login","version":"0.1.0","homepage":"https://ivarprudnikov.github.io/react-auth0-template","private":false,"dependencies":{"@auth0/auth0-spa-js":"^1.15.0","@testing-library/jest-dom":"^5.11.10","@testing-library/react":"^11.2.6","@testing-library/user-event":"^13.1.8","axios":"^0.21.1","bootstrap":"^4.6.0","jwt-decode":"^3.1.2","node-sass":"^5.0.0","react":"^17.0.2","react-dom":"^17.0.2","react-router-dom":"^5.2.0","react-scripts":"^4.0.3"},"scripts":{"start":"REACT_APP_VERSION=$(date \\"+%Y-%m-%d %H:%M\\") react-scripts start","build":"REACT_APP_VERSION=$(date \\"+%Y-%m-%d %H:%M\\") react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},41:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r,a,c=n(1),s=n.n(c),i=n(32),o=n.n(i),l=(n(41),n(9)),u=n(5),d=n.n(u),b=n(11),h=n(33),j=n(34),p=n(18),m={domain:"ivarprudnikov.eu.auth0.com",clientId:"EuHrJlslqdI6h5UOuAMtau6maPa05lRd",audience:"https://ivarprudnikov.com",scope:"openid profile email",loginCallbackUrl:p.homepage,logoutRedirectUrl:p.homepage},f=n(0),x=function(){return window.history.replaceState({},document.title,window.location.pathname)},O=s.a.createContext({}),v=function(){return Object(c.useContext)(O)},g=function(e){var t=e.children,n=e.onRedirectCallback,r=Object(c.useState)(!1),a=Object(l.a)(r,2),s=a[0],i=a[1],o=Object(c.useState)(null),u=Object(l.a)(o,2),p=u[0],v=u[1],g=Object(c.useState)(null),N=Object(l.a)(g,2),w=N[0],k=N[1],y=Object(c.useState)(!0),C=Object(l.a)(y,2),R=C[0],S=C[1];"function"!==typeof n&&(n=x),Object(c.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t,r,a,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.a)({domain:m.domain,client_id:m.clientId,audience:m.audience,scope:m.scope,redirect_uri:m.loginCallbackUrl});case 2:if(t=e.sent,k(t),!window.location.search.includes("code=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:r=e.sent,a=r.appState,n(a);case 10:return e.next=12,t.isAuthenticated();case 12:if(c=e.sent,i(c),!c){e.next=19;break}return e.next=17,t.getUser();case 17:s=e.sent,v(s);case 19:S(!1);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){console.error("initAuth0 failure",e),window.location.replace("/")}))}),[n]);var P=function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.next=3,w.handleRedirectCallback();case 3:return e.next=5,w.getUser();case 5:t=e.sent,S(!1),i(!0),v(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.getTokenSilently();case 3:t=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),console.log(e.t0),new Error("Could not obtain access token");case 10:return e.prev=10,e.abrupt("return",{raw:t,decoded:Object(h.a)(t)});case 14:throw e.prev=14,e.t1=e.catch(10),console.log(e.t1),new Error("Could not decode access token");case 18:case"end":return e.stop()}}),e,null,[[0,6],[10,14]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A();case 3:t=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",[]);case 9:return n=(t.decoded.scope||"")+"",e.abrupt("return",n.split(/\W/));case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return n=e.sent,e.abrupt("return",t&&t.length&&t.some((function(e){return n.indexOf(e)>-1})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(O.Provider,{value:{isAuthenticated:s,user:p,loading:R,handleRedirectCallback:P,getIdTokenClaims:function(){return w.getIdTokenClaims.apply(w,arguments)},loginWithRedirect:function(){return w.loginWithRedirect.apply(w,arguments)},getTokenSilently:A,hasAnyScopeAsync:I,getTokenWithPopup:function(){return w.getTokenWithPopup.apply(w,arguments)},logoutWithRedirect:function(){return w.logout({returnTo:m.logoutRedirectUrl})}},children:t})},N=n(10),w=function(){var e=v(),t=e.isAuthenticated,n=e.loginWithRedirect,r=e.logoutWithRedirect;return Object(f.jsx)("nav",{className:"navbar navbar-expand navbar-light bg-light",children:Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)(N.a,{className:"navbar-brand",to:"/react-auth0-template/",children:"Brnd"}),Object(f.jsx)("ul",{className:"navbar-nav mr-auto",children:Object(f.jsx)("li",{className:"nav-item-divider"})}),!t&&Object(f.jsx)("ul",{className:"navbar-nav",children:Object(f.jsx)("form",{className:"form-inline",children:Object(f.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:function(){return n({})},children:"Log in"})})}),t&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("ul",{className:"navbar-nav",children:[Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(N.a,{className:"nav-link",to:"/react-auth0-template/",children:"Home"})}),Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(N.a,{className:"nav-link",to:"/react-auth0-template/profile",children:"Profile"})})]}),Object(f.jsx)("form",{className:"form-inline ml-4",children:Object(f.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){return r()},children:"Log out"})})]})]})})},k=n(2),y=n(12),C=n.n(y),R=function(){var e=v(),t=e.loading,n=e.user,r=Object(c.useState)({}),a=Object(l.a)(r,2),s=a[0],i=a[1];return Object(c.useEffect)((function(){!t&&n&&C.a.get("/me").then((function(e){return i(e.data)})).catch((function(){i({})}))}),[t,n]),t||!n?Object(f.jsx)("div",{className:"d-flex min-vh-100 align-items-center justify-content-center",children:Object(f.jsx)("span",{className:"spinner-border","aria-label":"Loading ..."})}):Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"row",children:[Object(f.jsx)("div",{className:"col-2",children:Object(f.jsx)("img",{src:n.picture,alt:"Profile",className:"img-fluid"})}),Object(f.jsxs)("div",{className:"col-sm-4",children:[Object(f.jsx)("h2",{children:n.name}),Object(f.jsx)("p",{children:n.email})]}),Object(f.jsxs)("div",{className:"col-sm-6",children:[Object(f.jsx)("code",{className:"p-3 bg-dark text-light d-block mb-3",children:JSON.stringify(n,null,2)}),Object(f.jsx)("pre",{className:"p-3 bg-dark text-light d-block",children:JSON.stringify(s,null,2)})]})]})})},S=n(4),P=Object(S.a)(),A=n(21),E=n(36),I=function(e){var t=e.component,n=e.path,r=Object(E.a)(e,["component","path"]),a=v(),s=a.loading,i=a.isAuthenticated,o=a.loginWithRedirect;Object(c.useEffect)((function(){s||i||function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({appState:{targetUrl:n}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[s,i,o,n]);return Object(f.jsx)(k.a,Object(A.a)({path:n,render:function(e){return!0===i?Object(f.jsx)(t,Object(A.a)({},e)):null}},r))},T=function(){return Object(f.jsxs)("div",{className:"container text-center",children:[Object(f.jsx)("h1",{className:"display-1",children:"Super fancy app"}),Object(f.jsx)("div",{className:"mt-5",children:Object(f.jsx)(N.a,{className:"btn btn-lg btn-primary mr-2",to:"/react-auth0-template/profile",children:"Protected profile page"})})]})},U=[],W=[];var _=function(){C.a.defaults.baseURL="https://te60oj36jd.execute-api.eu-west-1.amazonaws.com/Prod/";var e=v(),t=e.loading,n=e.getTokenSilently,s=Object(c.useState)(!1),i=Object(l.a)(s,2),o=i[0],u=i[1],d=Object(c.useState)(!1),b=Object(l.a)(d,2),h=b[0],j=b[1],p=Object(c.useState)(!1),m=Object(l.a)(p,2),x=m[0],O=m[1],g=401,N=403,y=500;function S(e){switch(e){case g:for(;U.length>0;)U.shift().call();u(!1);break;case N:for(;W.length>0;)W.shift().call();j(!1);break;default:u(!1),j(!1),O(!1)}}null!=r&&C.a.interceptors.request.eject(r),null!=a&&C.a.interceptors.response.eject(a),t||(r=C.a.interceptors.request.use((function(e){return console.log("axiosRequestInterceptor"),n().then((function(t){return console.log("axiosRequestInterceptor token",t),e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t.raw),e})).catch((function(t){return console.log("axiosRequestInterceptor catch",t),e}))})),a=C.a.interceptors.response.use((function(e){return e}),(function(e){if(console.log(e),e&&e.response)switch(e.response.status){case g:return new Promise((function(e){U.push(e),u(!0)})).then((function(){return Promise.reject(e)}));case N:return new Promise((function(e){W.push(e),j(!0)})).then((function(){return Promise.reject(e)}));default:return e.response.status>=y&&O(!0),Promise.reject(e)}else O(!0);return Promise.reject(e)})));var A=null,E=null,_=null,q=null;return o&&(E=Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"alert alert-danger mb-2",children:["Authentication is required",Object(f.jsx)("button",{type:"button",onClick:function(){return S(g)},className:"close","aria-label":"Close",children:Object(f.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})})),h&&(_=Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"alert alert-danger mb-2",children:["You're not authorized to perform an action.",Object(f.jsx)("button",{type:"button",onClick:function(){return S(N)},className:"close","aria-label":"Close",children:Object(f.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})})),x&&(q=Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"alert alert-danger mb-2",children:["Server responded with an unexpected error.",Object(f.jsx)("button",{type:"button",onClick:function(){return S(y)},className:"close","aria-label":"Close",children:Object(f.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})})),(E||_||q)&&(A=Object(f.jsxs)("div",{className:"bg-dark p-3",children:[E,_,q]})),Object(f.jsxs)("div",{className:"d-flex min-vh-100 flex-column",children:[A,Object(f.jsxs)(k.b,{history:P,children:[Object(f.jsx)("header",{children:Object(f.jsx)(w,{})}),Object(f.jsxs)("main",{children:[t&&Object(f.jsx)("div",{className:"d-flex align-items-center justify-content-center my-auto",children:Object(f.jsx)("span",{className:"spinner-border","aria-label":"Loading ..."})}),!t&&Object(f.jsxs)(k.c,{children:[Object(f.jsx)(k.a,{path:"/react-auth0-template/",exact:!0,component:T}),Object(f.jsx)(I,{path:"/react-auth0-template/profile",component:R})]})]}),Object(f.jsx)("footer",{className:"p-4 text-center bg-primary text-light mt-auto",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(f.jsxs)("small",{children:["Version: ",window.REACT_APP_VERSION]}),Object(f.jsx)("span",{className:"mx-auto"}),Object(f.jsx)("a",{href:"https://github.com/ivarprudnikov/react-auth0-template",className:"btn btn-sm btn-outline-light mr-3",children:"Source code on Github"}),Object(f.jsx)("a",{href:"https://www.ivarprudnikov.com/auth0-authentication-website-react/",className:"btn btn-sm btn-outline-light",children:"About this implementation"})]})})})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(f.jsx)(g,{onRedirectCallback:function(e){P.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)},children:Object(f.jsx)(_,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[71,1,2]]]);
//# sourceMappingURL=main.43d65d02.chunk.js.map